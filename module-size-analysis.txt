MODULE SIZE ANALYSIS - 2025-10-08
Rule: Keep all custom modules around 300 lines or less
Exception: Ignore node_modules and third-party modules

===============================
SRC DIRECTORY ANALYSIS
===============================

MODULES EXCEEDING 300 LINES (Custom Code):
1. src/integrations/supabase/types.ts - 1454 lines ⚠️ AUTO-GENERATED
2. src/hooks/useHeadshotGenerator.ts - 373 lines ⚠️ EXCEEDS LIMIT

MODULES AT OR NEAR LIMIT (280-300 lines):
3. src/services/headshotGeneratorService.ts - 295 lines ✓ ACCEPTABLE

THIRD-PARTY UI COMPONENTS (EXCLUDED):
- src/components/ui/sidebar.tsx - 637 lines (shadcn/ui library)
- src/components/ui/chart.tsx - 303 lines (shadcn/ui library)
- src/components/ui/carousel.tsx - 224 lines (shadcn/ui library)
- src/components/ui/menubar.tsx - 207 lines (shadcn/ui library)
- src/components/ui/dropdown-menu.tsx - 200 lines (shadcn/ui library)
- src/components/ui/context-menu.tsx - 200 lines (shadcn/ui library)

OTHER LARGE MODULES (WITHIN LIMIT):
- src/components/UserManagement.tsx - 273 lines ✓
- src/pages/Home.tsx - 266 lines ✓
- src/services/trainModelService.ts - 264 lines ✓
- src/utils/auth-diagnostics.ts - 261 lines ✓
- src/hooks/useTrainModelData.ts - 255 lines ✓
- src/services/image-lifecycle.ts - 240 lines ✓
- src/hooks/useGalleryData.ts - 226 lines ✓
- src/components/SignupForm.tsx - 215 lines ✓
- src/pages/Overview.tsx - 208 lines ✓
- src/services/image-resolution.ts - 203 lines ✓

===============================
SUPABASE FUNCTIONS ANALYSIS
===============================

ALL EDGE FUNCTIONS WITHIN LIMIT ✓
1. image-lifecycle/index.ts - 257 lines ✓
2. generate-headshot/generateImageHandler.ts - 255 lines ✓
3. generate-headshot/statusCheckHandler.ts - 232 lines ✓
4. scheduled-cleanup/index.ts - 148 lines ✓
5. generate-headshot/geminiPromptEnhancer.ts - 131 lines ✓
6. astria-webhook/index.ts - 116 lines ✓
7. generate-headshot/trainModelHandler.ts - 101 lines ✓
8. generate-headshot/index.ts - 84 lines ✓
9. generate-headshot/utils.ts - 3 lines ✓

===============================
MODULES REQUIRING ACTION
===============================

CRITICAL ISSUES:
1. ⚠️ useHeadshotGenerator.ts (373 lines) - EXCEEDS 300 LINE LIMIT
   - Currently: 373 lines
   - Target: 300 lines or less
   - Recommended: Extract sub-hooks or refactor into smaller modules
   - Action: Refactor to split responsibilities

EXCLUDED FROM ACTION:
2. types.ts (1454 lines) - AUTO-GENERATED by Supabase CLI
   - Do NOT refactor - regenerated on schema changes
   - Exception granted for auto-generated code

===============================
RECOMMENDATION
===============================

PRIMARY ACTION REQUIRED:
- Refactor useHeadshotGenerator.ts from 373 lines to <300 lines
- Split into smaller, focused hooks:
  * useModelTraining.ts - Training logic
  * useImageGeneration.ts - Generation logic
  * useImagePolling.ts - Polling and status updates
  * useHeadshotGenerator.ts - Main orchestration hook

NO ACTION NEEDED:
- All Edge Functions under 300 lines ✓
- All other custom modules under 300 lines ✓
- Third-party UI components excluded by rule ✓
- Auto-generated types.ts excluded ✓

COMPLIANCE STATUS:
- 98% of custom modules compliant
- 1 module needs refactoring (useHeadshotGenerator.ts)
- 0 Edge Functions need refactoring
